(this.webpackJsonpsyncho=this.webpackJsonpsyncho||[]).push([[18],{356:function(e,t,a){"use strict";a.r(t);var n=a(34),s=a.n(n),c=a(44),r=a(4),o=a(1),i=a.n(o),l=a.p+"static/media/favicon.d8fa18db.png",u=a(351),d=a(45),p=a.n(d),j=a(349),b=a(46),f=a(0);t.default=function(){var e=Object(o.useState)(""),t=Object(r.a)(e,2),a=t[0],n=t[1],d=Object(o.useState)(!1),m=Object(r.a)(d,2),O=m[0],h=m[1],v=Object(o.useState)(""),g=Object(r.a)(v,2),x=g[0],y=g[1],S=Object(o.useState)(!1),k=Object(r.a)(S,2),N=k[0],w=k[1],I=Object(o.useState)(!1),E=Object(r.a)(I,2),T=E[0],_=E[1],C=Object(o.useState)(!1),z=Object(r.a)(C,2),P=z[0],q=z[1],B=Object(o.useState)(!1),F=Object(r.a)(B,2),J=F[0],D=F[1],R=Object(o.useState)(!1),W=Object(r.a)(R,2),A=W[0],H=W[1],L=Object(o.useState)({}),$=Object(r.a)(L,2),G=($[0],$[1]),K=Object(o.useState)(!1),M=Object(r.a)(K,2),Q=M[0],U=M[1],V=Object(o.useState)(!1),X=Object(r.a)(V,2),Y=X[0],Z=X[1],ee=Object(o.useState)({open:!1,message:"",type:"success"}),te=Object(r.a)(ee,2),ae=te[0],ne=te[1],se=function(){var e=Object(c.a)(s.a.mark((function e(){var t,n,c,r,o,i,l,u,d,j,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={type:"login",email:a},!P){e.next=17;break}return e.prev=2,e.next=5,p.a.post("".concat("http://devapi.shycosafe.com/","send-otp"),t);case 5:(n=e.sent)&&(_(n.data.success),U(!1),c=n.data.message,ne({open:!0,message:void 0===c?"Otp sent successfully":c,type:"success"})),e.next=17;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0),r=e.t0.response&&e.t0.response.data||{},o=r.message,i=void 0===o?"Sorry! We are unable to process your request.":o,l=r.status_code,u=r.errors,d=void 0===u?{}:u,_(!1),U(!1),j=Object.keys(d),422===l&&j.length?(b={},j.forEach((function(e){return b[e]=d[e][0]})),G(b)):ne({open:!0,message:i,type:"error"});case 17:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=Object(c.a)(s.a.mark((function e(){var t,n,c,r,o,i,l,u,d,j;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={email:a,password:x},!J){e.next=17;break}return e.prev=2,e.next=5,p.a.post("".concat("http://devapi.shycosafe.com/","login"),t);case 5:(n=e.sent)&&(localStorage.setItem("accessToken",n.data.access_token),localStorage.setItem("refresh-token",n.data.refresh_token),H(!0),Z(!1),sessionStorage.setItem("logged",!0),sessionStorage.setItem("mailed",JSON.stringify(a))),e.next=17;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0),c=e.t0.response&&e.t0.response.data||{},r=c.message,o=void 0===r?"Sorry! We are unable to process your request.":r,i=c.status_code,l=c.errors,u=void 0===l?{}:l,_(!1),Z(!1),d=Object.keys(u),422===i&&d.length?(j={},d.forEach((function(e){return j[e]=u[e][0]})),G(j)):ne({open:!0,message:o,type:"error"});case 17:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){null!==localStorage.getItem("accessToken")&&H(!0)}),[]),Object(o.useEffect)((function(){if(A){var e=localStorage.getItem("accessToken"),t=JSON.stringify(e),a={Authorization:"Bearer ".concat(t.slice(1,-1))};p.a.get("".concat("http://devapi.shycosafe.com/","user-profile"),{headers:a}).then((function(e){if(e){var t=e.data.data;localStorage.setItem("email",t.email),localStorage.setItem("name","".concat(t.first_name," ").concat(t.last_name)),localStorage.setItem("role",t.role),"admin"===t.role&&(window.location.href="/leads"),_(e.data.success)}})).catch((function(e){console.warn(e)}))}}),[A]);var re=function(){var e=Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O||""===a||(q(!0),U(!0)),se();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)(Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se();case 1:case"end":return e.stop()}}),e)}))),[q,P]);var oe=function(){var e=Object(c.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),N&&O||(D(!0),Z(!0)),ce();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(o.useEffect)(Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ce();case 1:case"end":return e.stop()}}),e)}))),[D,J]);var ie=function(){ne({open:!1,message:"",type:"success"})};Object(o.useEffect)((function(){if(T){var e=setTimeout((function(){me(!1)}),3e4);return function(){return clearTimeout(e)}}}),[_,T]);var le=i.a.useState(30),ue=Object(r.a)(le,2),de=ue[0],pe=ue[1],je=Object(o.useState)(!0),be=Object(r.a)(je,2),fe=be[0],me=be[1];return Object(o.useEffect)((function(){if(T){var e=de>0&&setInterval((function(){return pe(de-1)}),1e3);return function(){return clearInterval(e)}}}),[de,_,T]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(b.default,{}),Object(f.jsxs)("div",{className:"login",children:[Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)("img",{src:l,alt:"logo"}),Object(f.jsxs)("form",{action:"post",className:"loginForm",onSubmit:oe,children:[Object(f.jsxs)("div",{className:"otp",children:[Object(f.jsxs)("div",{className:"textInput",children:[Object(f.jsxs)("div",{className:"text-input",children:[Object(f.jsx)("input",{className:"input",value:a,name:"email",onChange:function(e){n(e.target.value),h(!e.target.validity.valid)},pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,}$",type:"email",required:!0}),Object(f.jsxs)("label",{htmlFor:"email",className:"input-placeholder",children:["Email",Object(f.jsx)("span",{children:"*"})]})]}),O?Object(f.jsx)("p",{className:"error-text",children:"Please provide a valid email Id"}):null]}),T?Object(f.jsx)("button",{className:"redBtn resend",type:"button",onClick:re,disabled:fe,children:0===de?"Re-send OTP":"Re-send OTP(".concat(de,")")}):Object(f.jsx)("button",{className:"redBtn",type:"button",onClick:re,disabled:Q,children:Q?"Sending...":"Send OTP"})]}),T?Object(f.jsxs)("div",{className:"otp",children:[Object(f.jsxs)("div",{className:"textInput",children:[Object(f.jsxs)("div",{className:"text-input",children:[Object(f.jsx)("input",{value:x,type:"number",className:"input",name:"code",onChange:function(e){y(e.target.value),w(!e.target.validity.valid)},pattern:"[0-9]{6}",required:!0}),Object(f.jsxs)("label",{htmlFor:"code",className:"input-placeholder",children:["Enter OTP",Object(f.jsx)("span",{children:"*"})]})]}),N?Object(f.jsx)("p",{className:"error-text",children:"The code provided is not valid."}):null]}),Object(f.jsx)("button",{type:"submit",className:"redBtn",disabled:Y,children:"Login"})]}):null]})]}),Object(f.jsx)(u.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:ae.open,onClose:ie,autoHideDuration:5e3,children:Object(f.jsx)(j.a,{onClose:ie,severity:ae.type,variant:"filled",children:ae.message})})]})]})}}}]);
//# sourceMappingURL=18.7781d46f.chunk.js.map
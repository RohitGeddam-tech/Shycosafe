(this.webpackJsonpsyncho=this.webpackJsonpsyncho||[]).push([[17],{356:function(e,t,a){"use strict";a.r(t);var s=a(56),n=a.n(s),c=a(65),r=a(10),o=a(0),i=a.n(o),u=a.p+"static/media/favicon.d8fa18db.png",l=a(66),d=a.n(l),p=a(169),j=a(167),b=a(67),f=a(1);t.default=function(){var e=Object(o.useState)(""),t=Object(r.a)(e,2),a=t[0],s=t[1],l=Object(o.useState)(!1),m=Object(r.a)(l,2),O=m[0],h=m[1],v=Object(o.useState)(""),g=Object(r.a)(v,2),x=g[0],y=g[1],S=Object(o.useState)(!1),k=Object(r.a)(S,2),N=k[0],w=k[1],I=Object(o.useState)(!1),E=Object(r.a)(I,2),T=E[0],_=E[1],C=Object(o.useState)(!1),q=Object(r.a)(C,2),z=q[0],P=q[1],B=Object(o.useState)(!1),F=Object(r.a)(B,2),J=F[0],W=F[1],D=Object(o.useState)(!1),R=Object(r.a)(D,2),A=R[0],H=R[1],L=Object(o.useState)({}),$=Object(r.a)(L,2),G=($[0],$[1]),K=Object(o.useState)(!1),M=Object(r.a)(K,2),Q=M[0],U=M[1],V=Object(o.useState)(!1),X=Object(r.a)(V,2),Y=X[0],Z=X[1],ee=Object(o.useState)({open:!1,message:"",type:"success"}),te=Object(r.a)(ee,2),ae=te[0],se=te[1],ne=function(){var e=Object(c.a)(n.a.mark((function e(){var t,s,c,r,o,i,u,l,p,j,b;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={type:"login",email:a},!z){e.next=16;break}return e.prev=2,e.next=5,d.a.post("".concat("http://devapi.shycosafe.com/","send-otp"),t);case 5:(s=e.sent)&&(_(s.data.success),U(!1),c=s.data.message,se({open:!0,message:void 0===c?"Otp sent successfully":c,type:"success"})),e.next=16;break;case 9:e.prev=9,e.t0=e.catch(2),r=e.t0.response&&e.t0.response.data||{},o=r.message,i=void 0===o?"Sorry! We are unable to process your request.":o,u=r.status_code,l=r.errors,p=void 0===l?{}:l,_(!1),U(!1),j=Object.keys(p),422===u&&j.length?(b={},j.forEach((function(e){return b[e]=p[e][0]})),G(b)):se({open:!0,message:i,type:"error"});case 16:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=Object(c.a)(n.a.mark((function e(){var t,s,c,r,o,i,u,l,p,j;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={email:a,password:x},!J){e.next=16;break}return e.prev=2,e.next=5,d.a.post("".concat("http://devapi.shycosafe.com/","login"),t);case 5:(s=e.sent)&&(localStorage.setItem("accessToken",s.data.access_token),localStorage.setItem("refresh-token",s.data.refresh_token),H(!0),Z(!1),sessionStorage.setItem("logged",!0),sessionStorage.setItem("mailed",JSON.stringify(a))),e.next=16;break;case 9:e.prev=9,e.t0=e.catch(2),c=e.t0.response&&e.t0.response.data||{},r=c.message,o=void 0===r?"Sorry! We are unable to process your request.":r,i=c.status_code,u=c.errors,l=void 0===u?{}:u,_(!1),Z(!1),p=Object.keys(l),422===i&&p.length?(j={},p.forEach((function(e){return j[e]=l[e][0]})),G(j)):se({open:!0,message:o,type:"error"});case 16:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){null!==localStorage.getItem("accessToken")&&H(!0)}),[]),Object(o.useEffect)((function(){if(A){var e=localStorage.getItem("accessToken"),t=JSON.stringify(e),a={Authorization:"Bearer ".concat(t.slice(1,-1))};d.a.get("".concat("http://devapi.shycosafe.com/","user-profile"),{headers:a}).then((function(e){if(e){var t=e.data.data;localStorage.setItem("email",t.email),localStorage.setItem("name","".concat(t.first_name," ").concat(t.last_name)),localStorage.setItem("role",t.role),"admin"!==t.role&&"assistant_admin"!==t.role||(window.location.href="/leads"),_(e.data.success)}})).catch((function(e){var t=e.response&&e.response.data||{},a=t.message,s=void 0===a?"Sorry! We are unable to process your request.":a,n=t.status_code,c=t.errors,r=void 0===c?{}:c,o=Object.keys(r);if(422===n&&o.length){var i={};o.forEach((function(e){return i[e]=r[e][0]})),G(i)}else se({open:!0,message:s,type:"error"})}))}}),[A]);var re=function(){var e=Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O||""===a||(P(!0),U(!0)),ne();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)(Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ne();case 1:case"end":return e.stop()}}),e)}))),[P,z]);var oe=function(){var e=Object(c.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),N&&O||(W(!0),Z(!0)),ce();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(o.useEffect)(Object(c.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ce();case 1:case"end":return e.stop()}}),e)}))),[W,J]);var ie=function(){se({open:!1,message:"",type:"success"})};Object(o.useEffect)((function(){if(T){var e=setTimeout((function(){me(!1)}),3e4);return function(){return clearTimeout(e)}}}),[_,T]);var ue=i.a.useState(30),le=Object(r.a)(ue,2),de=le[0],pe=le[1],je=Object(o.useState)(!0),be=Object(r.a)(je,2),fe=be[0],me=be[1];return Object(o.useEffect)((function(){if(T){var e=de>0&&setInterval((function(){return pe(de-1)}),1e3);return function(){return clearInterval(e)}}}),[de,_,T]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(b.default,{}),Object(f.jsxs)("div",{className:"login",children:[Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)("img",{src:u,alt:"logo"}),Object(f.jsxs)("form",{action:"post",className:"loginForm",onSubmit:oe,children:[Object(f.jsxs)("div",{className:"otp",children:[Object(f.jsxs)("div",{className:"textInput",children:[Object(f.jsxs)("div",{className:"text-input",children:[Object(f.jsx)("input",{className:"input",value:a,name:"email",onChange:function(e){s(e.target.value),h(!e.target.validity.valid)},pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,}$",type:"email",required:!0}),Object(f.jsxs)("label",{htmlFor:"email",className:"input-placeholder",children:["Email",Object(f.jsx)("span",{children:"*"})]})]}),O?Object(f.jsx)("p",{className:"error-text",children:"Please provide a valid email Id"}):null]}),T?Object(f.jsx)("button",{className:"redBtn resend",type:"button",onClick:re,disabled:fe,children:0===de?"Re-send OTP":"Re-send OTP(".concat(de,")")}):Object(f.jsx)("button",{className:"redBtn",type:"button",onClick:re,disabled:Q,children:Q?"Sending...":"Send OTP"})]}),T?Object(f.jsxs)("div",{className:"otp",children:[Object(f.jsxs)("div",{className:"textInput",children:[Object(f.jsxs)("div",{className:"text-input",children:[Object(f.jsx)("input",{value:x,type:"number",className:"input",name:"code",onChange:function(e){y(e.target.value),w(!e.target.validity.valid)},pattern:"[0-9]{6}",required:!0}),Object(f.jsxs)("label",{htmlFor:"code",className:"input-placeholder",children:["Enter OTP",Object(f.jsx)("span",{children:"*"})]})]}),N?Object(f.jsx)("p",{className:"error-text",children:"The code provided is not valid."}):null]}),Object(f.jsx)("button",{type:"submit",className:"redBtn",disabled:Y,children:"Login"})]}):null]})]}),Object(f.jsx)(p.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:ae.open,onClose:ie,autoHideDuration:5e3,children:Object(f.jsx)(j.a,{onClose:ie,severity:ae.type,variant:"filled",children:ae.message})})]})]})}}}]);
//# sourceMappingURL=17.8ebde208.chunk.js.map